
launch:
	cp envs/.env.brand brand/.env
	cp envs/.env.issuer issuer/.env
	cp envs/.env.acquirer acquirer/.env
	cp envs/.env.user user/.env
	cp envs/.env.merchant merchant/.env
	cp -r credentials/user/* user/config/credentials
	cp -r credentials/merchant/* merchant/config/credentials
	docker compose up -d --build
	docker compose exec brand bin/setup
	docker compose exec issuer bin/setup
	docker compose exec acquirer bin/setup
	make issuer/contract
	make acquirer/contract

reset:
	docker compose down --volumes
	make launch

issuer/contract:
	@curl -X POST http://localhost:3001/contracts >& /dev/null

issuer/login:
	@open -na "Google Chrome" --args --new-window --guest http://localhost:3001/login

acquirer/contract:
	@curl -X POST http://localhost:3002/contracts >& /dev/null

user/listunspent:
	@docker compose exec user bin/cli listunspent

user/payment:
	@docker compose exec user bin/cli sendtovc eyJhbGciOiJFUzI1NksiLCJ0eXAiOiJKV1QifQ.eyJpYXQiOjE2OTg1NzMxNTgsImV4cCI6MTg1NjQyNTk1OCwidmMiOnsiQGNvbnRleHQiOlsiaHR0cHM6Ly93d3cudzMub3JnLzIwMTgvY3JlZGVudGlhbHMvdjEiXSwidHlwZSI6WyJWZXJpZmlhYmxlQ3JlZGVudGlhbCJdLCJpc3N1ZXIiOiJkaWQ6aW9uOkVpREdyRHg4b1dwcklZN2xRZ2xtMlZzNkhDOEx2TTRPVnh0STNReEtPOVNCMUE6ZXlKa1pXeDBZU0k2ZXlKd1lYUmphR1Z6SWpwYmV5SmhZM1JwYjI0aU9pSnlaWEJzWVdObElpd2laRzlqZFcxbGJuUWlPbnNpY0hWaWJHbGpTMlY1Y3lJNlczc2lhV1FpT2lKemFXZHVhVzVuTFd0bGVTSXNJbkIxWW14cFkwdGxlVXAzYXlJNmV5SmpjbllpT2lKelpXTndNalUyYXpFaUxDSnJkSGtpT2lKRlF5SXNJbmdpT2lKRGFHUTVXbGN6TkhsNWF6TTBOekpaVG01NlZYazFXbGwwZVV0bldqVTNaa0oxZGpsVFVYUjRkbk5KSWl3aWVTSTZJazVDVjNONWRWZFdVM000VlZWZk9GRlZPV3h6ZGtnM1ZsOURhazV3TlVoTlIyaENRbE14TFU1SlRIY2lmU3dpY0hWeWNHOXpaWE1pT2xzaVlYVjBhR1Z1ZEdsallYUnBiMjRpWFN3aWRIbHdaU0k2SWtWalpITmhVMlZqY0RJMU5tc3hWbVZ5YVdacFkyRjBhVzl1UzJWNU1qQXhPU0o5WFN3aWMyVnlkbWxqWlhNaU9sdGRmWDFkTENKMWNHUmhkR1ZEYjIxdGFYUnRaVzUwSWpvaVJXbENRM0JYTURFelYycGZkR1phWlV0VE1XSndWbXhPYTFkYWFtbEVhSFJqVkhacU5XRm5kWGQ0ZDB4a2R5SjlMQ0p6ZFdabWFYaEVZWFJoSWpwN0ltUmxiSFJoU0dGemFDSTZJa1ZwUTJONlVERmxjMjR4UVdSR1VGOXBlVEpzUkZjeFpVTlpOWEJIYjJkalJXRlBiVEpOUWt0a09FVjNTbWNpTENKeVpXTnZkbVZ5ZVVOdmJXMXBkRzFsYm5RaU9pSkZhVUpMWVROd01taHpSMjFqY1ZWaU5EQjRPVE4zTjFad2EzQklORUZ4VjNsb1RGVmtVREJyUTNCNmJVeDNJbjE5IiwiY3JlZGVudGlhbFN1YmplY3QiOnsiaWQiOiJkaWQ6aW9uOkVpQ25GUkgzVjVJazd5Wm5NRTNGbnFGU0R1cjlyZkZiSlZDem1MME55ZzhXUVE6ZXlKa1pXeDBZU0k2ZXlKd1lYUmphR1Z6SWpwYmV5SmhZM1JwYjI0aU9pSnlaWEJzWVdObElpd2laRzlqZFcxbGJuUWlPbnNpY0hWaWJHbGpTMlY1Y3lJNlczc2lhV1FpT2lKemFXZHVhVzVuTFd0bGVTSXNJbkIxWW14cFkwdGxlVXAzYXlJNmV5SmpjbllpT2lKelpXTndNalUyYXpFaUxDSnJkSGtpT2lKRlF5SXNJbmdpT2lKelVraHJXRUZXU20xNGNTMXliMXBxTUdOVFkza3dlVGxEVUdsNE1sUk5NMHhpUTBaTVlrTjFTbFU0SWl3aWVTSTZJa010VTFGaVh6WTBZWHBNUlV4dU4xWXlUSEE0Y1ZSR2IxUlVibFV6Wm5BelNXWTJUekI0YlhwbWNGVWlmU3dpY0hWeWNHOXpaWE1pT2xzaVlYVjBhR1Z1ZEdsallYUnBiMjRpWFN3aWRIbHdaU0k2SWtWalpITmhVMlZqY0RJMU5tc3hWbVZ5YVdacFkyRjBhVzl1UzJWNU1qQXhPU0o5WFN3aWMyVnlkbWxqWlhNaU9sdGRmWDFkTENKMWNHUmhkR1ZEYjIxdGFYUnRaVzUwSWpvaVJXbENWRFJFU3pOV1QwZ3dWWFZpYUVoSE9FWnRkVE5FTkZRelJtSnZTekJ4YnpWcFpTMUlOWFZqUVdoMFVTSjlMQ0p6ZFdabWFYaEVZWFJoSWpwN0ltUmxiSFJoU0dGemFDSTZJa1ZwUW1oRmVGYzBSbWQwUTNKSFZuZEdNWEZPWjB0MU5URlVUazVGVUhrdE5HMU5UR0o1VnpBNFIzZDNTMmNpTENKeVpXTnZkbVZ5ZVVOdmJXMXBkRzFsYm5RaU9pSkZhVUpEWW1GU1lYWTFSMlYzU3paVFFrTjJhRzlWTUhGQlNERXpXa1l0WmxaT1UwMWpaME5FVW5GclVHSkJJbjE5IiwiZGVncmVlIjp7InR5cGUiOiJRdWF0dHJvV2FsbGV0IiwibmFtZSI6IldhbGxldCBvZiBRdWF0dHJvIHBheW1lbnQgbmV0d29yayJ9fX0sInN1YiI6ImRpZDppb246RWlDbkZSSDNWNUlrN3labk1FM0ZucUZTRHVyOXJmRmJKVkN6bUwwTnlnOFdRUTpleUprWld4MFlTSTZleUp3WVhSamFHVnpJanBiZXlKaFkzUnBiMjRpT2lKeVpYQnNZV05sSWl3aVpHOWpkVzFsYm5RaU9uc2ljSFZpYkdsalMyVjVjeUk2VzNzaWFXUWlPaUp6YVdkdWFXNW5MV3RsZVNJc0luQjFZbXhwWTB0bGVVcDNheUk2ZXlKamNuWWlPaUp6WldOd01qVTJhekVpTENKcmRIa2lPaUpGUXlJc0luZ2lPaUp6VWtocldFRldTbTE0Y1MxeWIxcHFNR05UWTNrd2VUbERVR2w0TWxSTk0weGlRMFpNWWtOMVNsVTRJaXdpZVNJNklrTXRVMUZpWHpZMFlYcE1SVXh1TjFZeVRIQTRjVlJHYjFSVWJsVXpabkF6U1dZMlR6QjRiWHBtY0ZVaWZTd2ljSFZ5Y0c5elpYTWlPbHNpWVhWMGFHVnVkR2xqWVhScGIyNGlYU3dpZEhsd1pTSTZJa1ZqWkhOaFUyVmpjREkxTm1zeFZtVnlhV1pwWTJGMGFXOXVTMlY1TWpBeE9TSjlYU3dpYzJWeWRtbGpaWE1pT2x0ZGZYMWRMQ0oxY0dSaGRHVkRiMjF0YVhSdFpXNTBJam9pUldsQ1ZEUkVTek5XVDBnd1ZYVmlhRWhIT0VadGRUTkVORlF6Um1KdlN6QnhielZwWlMxSU5YVmpRV2gwVVNKOUxDSnpkV1ptYVhoRVlYUmhJanA3SW1SbGJIUmhTR0Z6YUNJNklrVnBRbWhGZUZjMFJtZDBRM0pIVm5kR01YRk9aMHQxTlRGVVRrNUZVSGt0TkcxTlRHSjVWekE0UjNkM1MyY2lMQ0p5WldOdmRtVnllVU52YlcxcGRHMWxiblFpT2lKRmFVSkRZbUZTWVhZMVIyVjNTelpUUWtOMmFHOVZNSEZCU0RFeldrWXRabFpPVTAxalowTkVVbkZyVUdKQkluMTkiLCJqdGkiOiJJRCBvZiBWQyIsIm5iZiI6MTY5ODU3MzE1OCwiaXNzIjoiZGlkOmlvbjpFaURHckR4OG9XcHJJWTdsUWdsbTJWczZIQzhMdk00T1Z4dEkzUXhLTzlTQjFBOmV5SmtaV3gwWVNJNmV5SndZWFJqYUdWeklqcGJleUpoWTNScGIyNGlPaUp5WlhCc1lXTmxJaXdpWkc5amRXMWxiblFpT25zaWNIVmliR2xqUzJWNWN5STZXM3NpYVdRaU9pSnphV2R1YVc1bkxXdGxlU0lzSW5CMVlteHBZMHRsZVVwM2F5STZleUpqY25ZaU9pSnpaV053TWpVMmF6RWlMQ0pyZEhraU9pSkZReUlzSW5naU9pSkRhR1E1V2xjek5IbDVhek0wTnpKWlRtNTZWWGsxV2xsMGVVdG5XalUzWmtKMWRqbFRVWFI0ZG5OSklpd2llU0k2SWs1Q1YzTjVkVmRXVTNNNFZWVmZPRkZWT1d4emRrZzNWbDlEYWs1d05VaE5SMmhDUWxNeExVNUpUSGNpZlN3aWNIVnljRzl6WlhNaU9sc2lZWFYwYUdWdWRHbGpZWFJwYjI0aVhTd2lkSGx3WlNJNklrVmpaSE5oVTJWamNESTFObXN4Vm1WeWFXWnBZMkYwYVc5dVMyVjVNakF4T1NKOVhTd2ljMlZ5ZG1salpYTWlPbHRkZlgxZExDSjFjR1JoZEdWRGIyMXRhWFJ0Wlc1MElqb2lSV2xDUTNCWE1ERXpWMnBmZEdaYVpVdFRNV0p3Vm14T2ExZGFhbWxFYUhSalZIWnFOV0ZuZFhkNGQweGtkeUo5TENKemRXWm1hWGhFWVhSaElqcDdJbVJsYkhSaFNHRnphQ0k2SWtWcFEyTjZVREZsYzI0eFFXUkdVRjlwZVRKc1JGY3haVU5aTlhCSGIyZGpSV0ZQYlRKTlFrdGtPRVYzU21jaUxDSnlaV052ZG1WeWVVTnZiVzFwZEcxbGJuUWlPaUpGYVVKTFlUTndNbWh6UjIxamNWVmlOREI0T1ROM04xWndhM0JJTkVGeFYzbG9URlZrVURCclEzQjZiVXgzSW4xOSJ9.pyWAd-VOlvQR-VCM3QAzU2xNUMIGAgye2H0_QkB6lTFhk3jeZEfElyGRtHM4_yFoccMG65TNeLFAt3l3j65vRw 10

merchant/listunspent:
	@docker compose exec merchant bin/cli listunspent

merchant/withdraw:
	@docker compose exec merchant bin/cli sendwithdrawrequest 10
